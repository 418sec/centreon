<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuring Broker &mdash; Centreon 2.7.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Centreon 2.7.0 documentation" href="../index.html" />
    <link rel="up" title="Administration" href="index.html" />
    <link rel="next" title="Upgrade" href="../upgrade/index.html" />
    <link rel="prev" title="Managing SNMP traps with Centreon" href="02k.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../upgrade/index.html" title="Upgrade"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="02k.html" title="Managing SNMP traps with Centreon"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Centreon 2.7.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Administration</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="configuring-broker">
<h1>Configuring Broker<a class="headerlink" href="#configuring-broker" title="Permalink to this headline">¶</a></h1>
<p>This section aims to help user understand how Centreon Broker works and how
it should be configured. It references Centreon&#8217;s best practices and
describe the various options used by Centreon Broker.</p>
<div class="section" id="general-overview">
<h2>General Overview<a class="headerlink" href="#general-overview" title="Permalink to this headline">¶</a></h2>
<p>Centreon Broker is at is core a simple multiplexing engine. It takes events
from <em>Inputs</em> and send them to various <em>Outputs</em>. <em>Inputs</em> are typically other
instances of Centreon Broker over TCP/IP, while <em>Outputs</em> can be a
SQL database, other brokers, a BI/BAM engine, Centreon Map, etc.</p>
<p>Each <em>Input</em> or <em>Output</em> has a <em>type</em> that describe what it does and several
parameters, some of them mandatory and other optional. Additionally,
an <em>Output</em> can have a <em>Failover</em> that will start when the <em>Output</em> is
in an error state to allow retention of data.</p>
<p>An important distinction to make is the standalone Centreon Broker versus
a Centreon Broker installed as Centreon Engine&#8217;s module. Both have the
exact same capabilities and support the same <em>Inputs</em> and <em>Outputs</em>. The
difference is that Centreon Broker configured as a module will be
automatically started when Centreon Engine starts and automatically generates
the events associated to this Centreon Engine. Often, those modules only have
one <em>Output</em> to an instance of Centreon Broker acting as a concentrator.</p>
</div>
<div class="section" id="main-configuration-page">
<h2>Main Configuration Page<a class="headerlink" href="#main-configuration-page" title="Permalink to this headline">¶</a></h2>
<p>This section lists all the instances of Centreon Broker configured in your park,
either in standalone or module mode. Each instance has a name, is associated
with a poller, has a number of <em>Inputs</em>, <em>Outputs</em>, and <em>Loggers</em>, and can be
&#8216;enabled&#8217; or &#8216;disabled&#8217;.</p>
<p>A poller of type &#8216;Central&#8217; will have three instances of Centreon Broker by
default. One Centreon Broker installed as a module for Centreon Engine
(here called <em>central-module-master</em>), one Centreon Broker acting as a
stand-alone concentrator (here called <em>central-broker-master</em>) and one
Centreon Broker specialized in generating the RRD data used by the graphs
(here called <em>central-rrd-master</em>). A best practice is to always use
a separate instance of Centreon Broker to generate RRD data. This way, an issue
in the RRD stack will not cause any issue in your main monitoring.</p>
<p>As expected, <em>central-module-master</em> has only one <em>Output</em> and zero <em>Input</em>.
Configured as a module to Centreon Engine, it generates events on its own
and forward them to the standalone instance of Centreon Broker.</p>
<p>A poller generally only have an instance of Centreon Broker,
configured as a module for Centreon Engine.</p>
</div>
<div class="section" id="broker-general-configuration-page">
<h2>Broker General Configuration Page<a class="headerlink" href="#broker-general-configuration-page" title="Permalink to this headline">¶</a></h2>
<p>This section lists all the general options associated with an instance of
Centreon Broker.</p>
<p>Main options:</p>
<dl class="docutils">
<dt>Poller</dt>
<dd>The poller where this instance lives.</dd>
<dt>Name</dt>
<dd>The name of this instance.</dd>
<dt>Config file name</dt>
<dd>The name of the configuration file used by this instance.</dd>
<dt>Retention path</dt>
<dd>When an <em>Output</em> is in an error state, a <em>Failover</em> is
launched. <em>Failovers</em> save data in files called retention files.
Those in turn are saved in the directory specified here.
Best practice is &#8216;/var/lib/centreon-broker/&#8217;</dd>
<dt>Status</dt>
<dd>This is used to enable or disable this instance.</dd>
</dl>
<p>Log options:</p>
<dl class="docutils">
<dt>Write timestamp</dt>
<dd>If activated, each log entry is preceded by the timestamp of the time it was
written down.
This is useful to know when an error occured. Best practice is &#8216;Yes&#8217;.</dd>
<dt>Write thread id</dt>
<dd>If activated, each log entry is preceded by the ID of the thread being
executed at this instant.
This is only useful for advanced debugging purpose. Best practice is &#8216;No&#8217;.</dd>
</dl>
<p>Advanced Options:</p>
<dl class="docutils">
<dt>Statistics</dt>
<dd>Centreon Broker has a mechanism of on-demand status reporting that can be
enabled here. This is used by Centreon Web to check the status
of this instance at any time, to know which <em>Inputs</em> and <em>Outputs</em> are in
an error state, and to generate various statistics on event processing.
Best practice is &#8216;Yes&#8217;.</dd>
<dt>Correlation</dt>
<dd>Centreon Broker has a mechanism of top-level correlation.
This should only be actived if top-level correlation has been properly
configured in Centreon Web. In all other cases, default to &#8216;No&#8217;.</dd>
<dt>Event queue max size</dt>
<dd>The max size of the in-memory queue, in events.
If the number of events in memory exceeds this number, Centreon Broker
will start to use &#8216;temporary files&#8217; to prevent Broker from using too much
memory at the cost of additional disk I/O. The exact number can be tweaked
to use more or less memory. A good default is &#8216;50000&#8217;.</dd>
</dl>
<p>If &#8216;Statistics&#8217; is enabled, on-demand status can be queried manually through
a file placed in /var/lib/centreon-broker/<em>name</em>.stats.</p>
</div>
<div class="section" id="broker-input-configuration-page">
<h2>Broker Input Configuration Page<a class="headerlink" href="#broker-input-configuration-page" title="Permalink to this headline">¶</a></h2>
<p>This section lists all the <em>Inputs</em> activated for this instance of
Centreon Broker. Centreon Broker can have as many <em>Inputs</em> as needed.</p>
<p>Inputs read events from a TCP connection. All <em>Inputs</em> have the following
parameters:</p>
<dl class="docutils">
<dt>Name</dt>
<dd>The name of the input. Must be unique.</dd>
<dt>Serialization protocol</dt>
<dd>The protocol that was used to serialize the data.
Can be either &#8216;BBDO&#8217; or &#8216;NDO&#8217;. NDO is an old textual protocol that suffers
from very poor performance, poor density of data, and poor security. BBDO
is a next-gen binary protocol that is performant and secure. NDO is
deprecated. It should never be used in new installation.
Best practice is &#8216;BBDO&#8217;.</dd>
<dt>Compression</dt>
<dd>If compression was used to serialize the data.
Can be &#8216;auto&#8217;, &#8216;yes&#8217;, or &#8216;no&#8217;. If left on &#8216;auto&#8217; Centreon Broker
will detect if compression was used while doing a TCP handshake
(or assume no compression was used for files). Default to &#8216;auto&#8217; for TCP,
&#8216;no&#8217; for files.</dd>
<dt>Filter category</dt>
<dd>The categories of events accepted by this <em>Input</em>.
If empty, no restriction on events accepted. If filled, only events
of the given type will be processed. <em>Input</em> that accept data from
Centreon Engines&#8217; Broker module should be set to accept only &#8216;Neb&#8217; events.</dd>
<dt>Connection Port</dt>
<dd>Which port will be used for the connection. Mandatory.</dd>
<dt>Host to connect to</dt>
<dd>This important parameter will decide if this input will
listen or attempt to initiate a connection. Left empty, this input
will listen on its given port. If filled, this input will attempt
to initiate a  connection to the given host/port.</dd>
<dt>Enable TLS encryption</dt>
<dd>Enable the encryption of the flux. For the encryption
to work, the private key file, the public certificate and the trusted CA&#8217;s
certificate need to be set on both end. Default to &#8216;auto&#8217;, i.e &#8216;no&#8217; unless
TCP negociation has been activated and the remote endpoint has activated
encryption.</dd>
<dt>Private Key File</dt>
<dd>The private key file used for the encryption.</dd>
<dt>Public certificate</dt>
<dd>The public certificate used for the encryption.</dd>
<dt>Trusted CA&#8217;s certificate</dt>
<dd>The trused CA certificate used for the encryption.</dd>
<dt>Enable negociation</dt>
<dd>Enable negociation. If &#8216;yes&#8217;, this <em>Intput</em> will try
to negociate encryption and compression with the remote endpoint.</dd>
<dt>One peer retention mode</dt>
<dd>By default, a listening input will accept any
number of incoming connections. In &#8216;one peer retention&#8217; mode only one
connection is accepted at the same time, on a first-come first-serve basis.
Default to &#8216;no&#8217;.</dd>
</dl>
<p>To reiterate, TCP <em>Input</em> can either listen on a given port or
can attempt to initiate a connection if a host is given. This allow flexible
network topology.</p>
</div>
<div class="section" id="broker-logger-configuration-page">
<h2>Broker Logger Configuration Page<a class="headerlink" href="#broker-logger-configuration-page" title="Permalink to this headline">¶</a></h2>
<p>This section lists all the loggers activated for this instance of
Centreon Broker. Centreon Broker can have as many loggers as needed.</p>
<p>For each logger, the parameters are:</p>
<dl class="docutils">
<dt>Type</dt>
<dd><p class="first">4 types of loggers are managed by Centreon Broker.</p>
<ol class="last arabic simple">
<li>&#8216;File&#8217;: This logger will write its log into the file specified into its
&#8216;name&#8217; parameter.</li>
<li>&#8216;Standard&#8217;: This logger will write into the standard output if named
&#8216;stdout&#8217; or &#8216;cout&#8217; or into the standard error output if named
&#8216;stderr&#8217; or &#8216;cerr&#8217;.</li>
<li>&#8216;Syslog&#8217;: This logger will write into the syslog as provided by the system, prefixed by &#8216;centreonbroker&#8217;.</li>
<li>&#8216;Monitoring&#8217;: This logger will write into the log of Centreon Engine. It can only be activated if this instance of Centreon Broker is a module.</li>
</ol>
</dd>
<dt>Name</dt>
<dd>The name of this logger. This name must be the path of a file if the
logger has the type &#8216;File&#8217; or &#8216;stdout&#8217;, &#8216;cout&#8217;, &#8216;stderr&#8217; or &#8216;cerr&#8217;
if the logger has the type &#8216;Standard&#8217;. This option is mandatory.</dd>
<dt>Configuration messages</dt>
<dd>Should configuration messages be logged?
Configuration messages are one-time messages that pop-up when Centreon Broker
is started. Default is &#8216;Yes&#8217;.</dd>
<dt>Debug messages</dt>
<dd>Should debug messages be logged?
Debug messages are messages used to debug Broker&#8217;s behavior. They are
extremely verbose and should not be used in a production environment.
Default is &#8216;No&#8217;.</dd>
<dt>Error messages</dt>
<dd>Should error messages be logged?
Error messages are messages logged when a runtime error occurs.
They are generally important. Default is &#8216;Yes&#8217;.</dd>
<dt>Informational messages</dt>
<dd>Should informational messages be logged?
Informational messages are messages that are used to provide an information
on a specific subject. They are somewhat verbose. Default is &#8216;No&#8217;.</dd>
<dt>Logging level</dt>
<dd>The level of the verbosity accepted by this logger.
The higher the verbosity, the more messages will be logged.
Default to &#8216;Base&#8217;.</dd>
</dl>
<p>Additionally, the type &#8216;File&#8217; has the following parameter:</p>
<dl class="docutils">
<dt>Max file size</dt>
<dd>The maximum size of log file in bytes.
When the file has reached its limit, old data will be overwritten
in a round robin fashion.</dd>
</dl>
<p>A Broker will usually have at least one &#8216;File&#8217; logger which will log
Configuration and Error messages. Others can be configured freely.
A maximal logger (every category to &#8216;Yes&#8217; and logging level to &#8216;Very detailed&#8217;)
is valuable to debug some issues, but be warned that it will generate
a very large amount of data quickly.</p>
</div>
<div class="section" id="broker-output-configuration-page">
<h2>Broker Output Configuration Page<a class="headerlink" href="#broker-output-configuration-page" title="Permalink to this headline">¶</a></h2>
<p>This section lists all the <em>Outputs</em> activated for this instance of
Centreon Broker. Centreon Broker can have as many <em>Outputs</em> as needed.</p>
<p>For each <em>Outputs</em>, the parameters are:</p>
<dl class="docutils">
<dt>Type</dt>
<dd><p class="first">There is a several types for <em>Outputs</em> managed by Centreon Broker.</p>
<ol class="last arabic simple">
<li>&#8216;TCP - IPV4&#8217; and &#8216;TCP - IPV6&#8217;: This <em>Output</em> forwards data to another
server, either another Centreon Broker or Centreon Map.</li>
<li>File: This <em>Output</em> write data into a file.</li>
<li>RRD: This <em>Output</em> will generate RRD data from performance data.</li>
<li>Storage: This <em>Output</em> will write metrics into the database and generate performance data.</li>
<li>SQL: This <em>Output</em> will write real time status into Centreon&#8217;s database.</li>
<li>Dumper Reader: This <em>Output</em> will read from a database when Broker is asked to synchronize databases.</li>
<li>Dumper Writer: This <em>Output</em> will write into a database when Broker is asked to synchronize databases.</li>
<li>BAM Monitoring: This <em>Output</em> will generate BAM data from raw events and update real time BAM status.</li>
<li>BAM Reporting: This <em>Output</em> will write long term BAM logs that can then be used by BI.</li>
</ol>
</dd>
<dt>Failover</dt>
<dd>A <em>Failover</em> is an <em>Output</em> that will be started when this <em>Output</em>
is in error state. Example are TCP connections gone haywire, MySQL server
suddenly disconnecting, etc.
By default, each <em>Output</em> has an automatic <em>Failover</em> that will
automatically store data in retention files and replay it when the primary
<em>Output</em> recover from its error state. This is what you want in 99% of the
case. Otherwhise, you can specify here another <em>Output</em> that will act
as a <em>Failover</em> if this is what you need.</dd>
<dt>Retry interval</dt>
<dd>When this <em>Output</em> is in error state, this parameter
control how much time the <em>Output</em> will wait before retrying.
Default is one attempt every 30 seconds.</dd>
<dt>Buffering timeout</dt>
<dd>When this <em>Output</em> is in error state, Centreon Broker
will wait this much time before launching the <em>Failover</em>. This is mainly
useful if you want to make Centreon Broker wait for another software to
initialize before activating its <em>Failover</em>. In all other cases, this should
not be used. Default is 0 seconds.</dd>
<dt>Filter category</dt>
<dd><p class="first">The categories of events accepted by this <em>Output</em>.
If empty, no restriction on events accepted. If filled, only events
of the given type will be processed. The exact best practices are <em>Output</em>
specific.</p>
<ol class="arabic simple">
<li>&#8216;BAM Reporting&#8217; should only accept &#8216;Bam&#8217; events.</li>
<li>&#8216;Dump Writer&#8217; should only accept &#8216;Dumper&#8217; events.</li>
<li>&#8216;RRD&#8217; should only accept &#8216;Storage&#8217; events.</li>
</ol>
<p class="last">In all other cases, no restriction should be configured.</p>
</dd>
</dl>
<p>Events generated by an <em>Output</em> are reinjected into Centreon Broker&#8217;s event
queue.</p>
<p>Some <em>Outputs</em> only works when consuming data generated by another <em>Output</em>.
A &#8216;RRD&#8217; <em>Output</em> consumes data from a Storage <em>Output</em>, a &#8216;Dumper Writer&#8217; consumes
data from a &#8216;Dumper Reader&#8217;, and a &#8216;BAM Reporting&#8217; <em>Output</em> consumes data
from a &#8216;BAM Monitoring&#8217; <em>Output</em>.</p>
<p>Centreon Web needs at least an active <em>Output</em> &#8216;SQL&#8217; to activate its real time
monitoring capabilities. The <em>Outputs</em> &#8216;Storage&#8217; and &#8216;RRD&#8217; are needed
to activate Centreon Web metric plotting. The <em>Output</em> &#8216;BAM Monitoring&#8217;
is needed for real time BAM data and the <em>Output</em> &#8216;BAM Reporting&#8217; for
BI report.</p>
<p>Due to the fully distributed nature of Centreon Broker, producer and consumer
<em>Outputs</em> can be located on logically or physically different instances, as
long as they are connected to each other.</p>
<p><strong>Important</strong>: Centreon Web 2.x features two databases, the configuration
database and the real time database. Those are respectively called &#8216;centreon&#8217;
and &#8216;centreon-storage&#8217;. Different <em>Outputs</em> expect different database
in their configuration.</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Output Type</th>
<th class="head">Expected database</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>SQL</td>
<td>centreon-storage</td>
</tr>
<tr class="row-odd"><td>Storage</td>
<td>centreon-storage</td>
</tr>
<tr class="row-even"><td>Dumper Reader</td>
<td>centreon</td>
</tr>
<tr class="row-odd"><td>Dumper Writer</td>
<td>centreon</td>
</tr>
<tr class="row-even"><td>BAM Monitoring</td>
<td>centreon</td>
</tr>
<tr class="row-odd"><td>BAM Reporting</td>
<td>centreon-storage</td>
</tr>
</tbody>
</table>
<div class="section" id="tcp-outputs">
<h3>TCP Outputs<a class="headerlink" href="#tcp-outputs" title="Permalink to this headline">¶</a></h3>
<p>TCP <em>Outputs</em> forward events to a a remote endpoint. As with TCP <em>Inputs</em>,
TCP <em>Output</em> can either listen on a given port or can attempt to
initiate a connection if a host parameter is given.
This allow flexible network topology.</p>
<p><em>Outputs</em> of type &#8216;TCP&#8217; have the following parameters:</p>
<dl class="docutils">
<dt>Serialization protocol</dt>
<dd>The protocol that will be used to serialize the data.
Can be either &#8216;BBDO&#8217; or &#8216;NDO&#8217;. NDO is an old textual protocol that suffers
from very poor performance, poor density of data, and poor security. BBDO
is a next-gen binary protocol that is performant and secure. NDO is
deprecated. It should never be used in new installation.
Best practice is &#8216;BBDO&#8217;.</dd>
<dt>Enable negociation</dt>
<dd>Enable negociation. If &#8216;yes&#8217;, this <em>Output</em> will try
to negociate encryption and compression with the remote endpoint.</dd>
<dt>Connection Port</dt>
<dd>Which port will be used for the connection. Mandatory.</dd>
<dt>Host to connect to</dt>
<dd>This important parameter will decide if this <em>Output</em> will
listen or attempt to initiate a connection. Left empty, this <em>Output</em>
will listen on its given port. If filled, this <em>Output</em> will attempt
to initiate a  connection to the given host/port.</dd>
<dt>Enable TLS encryption</dt>
<dd>Enable the encryption of the flux. For the encryption
to work, the private key file, the public certificate and the trusted CA&#8217;s
certificate need to be set on both end. Default to &#8216;auto&#8217;, i.e &#8216;no&#8217; unless
TCP negociation has been activated and the remote endpoint has activated
encryption.</dd>
<dt>Private Key File</dt>
<dd>The private key file used for the encryption.</dd>
<dt>Public certificate</dt>
<dd>The public certificate used for the encryption.</dd>
<dt>Trusted CA&#8217;s certificate</dt>
<dd>The trused CA certificate used for the encryption.</dd>
<dt>One peer retention mode</dt>
<dd>By default, a listening <em>Output</em> will accept any
number of incoming connections. In &#8216;one peer retention&#8217; mode only one
connection is accepted at the same time, on a first-come first-serve basis.
Default to &#8216;no&#8217;.</dd>
<dt>Compression</dt>
<dd>If compression should be used to serialize the data.
Can be &#8216;auto&#8217;, &#8216;yes&#8217;, or &#8216;no&#8217;. If left on &#8216;auto&#8217; Centreon Broker
will detect if compression is supported by the endpoint during a TCP
negociation. Default to &#8216;auto&#8217; for TCP.</dd>
<dt>Compression Level</dt>
<dd>The level of compression that should be used, from 1 to 9.
Default (or if not filled) is 6. The higher the compression level is,
the higher the compression will be at the cost of processing power.</dd>
<dt>Compression Buffer</dt>
<dd>The size of the compression buffer that should be used.
Best practice is &#8216;0&#8217; or nothing.</dd>
</dl>
</div>
<div class="section" id="file-outputs">
<h3>File Outputs<a class="headerlink" href="#file-outputs" title="Permalink to this headline">¶</a></h3>
<p>File <em>Outputs</em> send events into a file on the disk. Additionally, they have
the capability of replaying the data of this file if used as a <em>Failover</em>
<em>Output</em>. Most &#8216;File&#8217; <em>Outputs</em> will be used as <em>Failovers</em>.</p>
<p><em>Outputs</em> of type &#8216;File&#8217; have the following parameters:</p>
<dl class="docutils">
<dt>Serialization protocol</dt>
<dd>The protocol that will be used to serialize the data.
Can be either &#8216;BBDO&#8217; or &#8216;NDO&#8217;. NDO is an old textual protocol that suffers
from very poor performance, poor density of data, and poor security. BBDO
is a next-gen binary protocol that is performant and secure. NDO is
deprecated. It should never be used in new installation.
Best practice is &#8216;BBDO&#8217;.</dd>
<dt>File path</dt>
<dd>The path of the file being written to.</dd>
<dt>Compression</dt>
<dd>If compression should be used to serialize the data.
Can be &#8216;auto&#8217;, &#8216;yes&#8217;, or &#8216;no&#8217;. &#8216;auto&#8217; is equal to &#8216;no&#8217; for files.</dd>
<dt>Compression Level</dt>
<dd>The level of compression that should be used, from 1 to 9.
Default (or if not filled) is 6. The higher the compression level is,
the higher the compression will be at the cost of processing power.</dd>
<dt>Compression Buffer</dt>
<dd>The size of the compression buffer that should be used.
Best practice is &#8216;0&#8217; or nothing.</dd>
</dl>
</div>
<div class="section" id="rrd-outputs">
<h3>RRD Outputs<a class="headerlink" href="#rrd-outputs" title="Permalink to this headline">¶</a></h3>
<p>RRD <em>Outputs</em> generate RRD data (used by Centreon Web to generate graphs)
from metrics data generated by a &#8216;Storage&#8217; <em>Output</em>. Best practice is to
isolate this <em>Output</em> on its own instance of Centreon Broker to ensure
that an issue in the RRD stack will not have any effect on the main instance
of Centreon Broker.</p>
<p><em>Outputs</em> of type &#8216;RRD&#8217; have the following parameters:</p>
<dl class="docutils">
<dt>RRD file directory for metrics</dt>
<dd>The directory where the RRD files of the
metrics will be written.
A good default is /var/lib/centreon/metrics/.</dd>
<dt>RRD file directory for statuses</dt>
<dd>The directory where the RRD files of the
statuses will be written.
A good default is /var/lib/centreon/statuse/</dd>
<dt>TCP port</dt>
<dd>The port used by RRDCached, if RRDCached has been configured on
this server. If not, nothing.</dd>
<dt>Unix socket</dt>
<dd>The unix socket used by RRDCached, if RRDCached has been
configured on this server. If not, nothing.</dd>
<dt>Write metrics</dt>
<dd>Should RRD metric files be written? Default &#8216;yes&#8217;.</dd>
<dt>Write status</dt>
<dd>Should RRD status files be written? Default &#8216;yes&#8217;.</dd>
</dl>
</div>
<div class="section" id="storage-outputs">
<h3>Storage Outputs<a class="headerlink" href="#storage-outputs" title="Permalink to this headline">¶</a></h3>
<p>Perfdata storage <em>Outputs</em> save metric data into a database and generate RRD
data used by the &#8216;RRD&#8217; <em>Output</em>. This <em>Output</em> usually generates a lot of
queries and is very performance intensive. If Centreon Broker is slow, tweaking
the Maximum Queries Per Transaction parameter of this <em>Output</em> is the first
optimization to attempt.</p>
<p>This <em>Output</em> can be tasked to rebuild &#8216;RRD&#8217; data from a database of stored
metric data. This is usually a costly, slow process, during which it is still
able to process new metric data, though not as quickly.</p>
<p><em>Outputs</em> of type &#8216;Storage&#8217; have the following parameters:</p>
<dl class="docutils">
<dt>DB Type</dt>
<dd>The type of the database being accessed.
MariaDB is a state-of-the-art database that has been extensively tested
with Centreon. We advice the use of MariaDB.</dd>
<dt>DB Port</dt>
<dd>The port of the database being accessed.</dd>
<dt>DB User</dt>
<dd>The user used by this <em>Output</em> to connect to this database.</dd>
<dt>DB Name</dt>
<dd>The name of this database. In Centreon term, this is the database
containing the real-time monitoring data, generally called
&#8216;centreon-storage&#8217;.</dd>
<dt>DB Password</dt>
<dd>The password used by this <em>Output</em> to connect to this database.</dd>
<dt>Maximum queries per transaction</dt>
<dd>This parameter is used to batch several
queries in large transaction. This allow fine performance tuning but
can generate latency if not enough queries are generated to fill those batches.
The Default is 20000 queries per transaction. If you have very low load and
unexpectedly high latency, try lowering this number. If you have a very high
load and high latency, try raising this number.</dd>
<dt>Transaction commit timeout</dt>
<dd>How many seconds are allowed to pass before
a forced commit is made. Default is infinite. If you have very low
load and unexpectedly high latency, try 5 seconds.</dd>
<dt>Replication enabled</dt>
<dd>Should Centreon Broker check that the replication status
of this database is complete before trying to insert data in it? Only useful
if replication is enabled for this database.</dd>
<dt>Rebuild check interval in seconds</dt>
<dd>The amount of seconds between each rebuild check. Default 300 seconds.</dd>
<dt>Store in performance data in data_bin</dt>
<dd>Should this <em>Output</em> saves the metric
data in the database? Default &#8216;yes&#8217;. If &#8216;no&#8217;, this <em>Output</em> will generate
RRD data without saving them into the database, making a rebuild impossible.</dd>
<dt>Insert in index data</dt>
<dd>Insert new ids into the database. Default &#8216;no&#8217;.
This should never be modified unless prompted by Centreon Support or
explicitely written down into a documentation.</dd>
</dl>
</div>
<div class="section" id="sql-outputs">
<h3>SQL Outputs<a class="headerlink" href="#sql-outputs" title="Permalink to this headline">¶</a></h3>
<p>SQL <em>Outputs</em> save real time status data into the real time database
used by Centreon Web. This is the most important <em>Output</em> for the
operation of Centreon Web.</p>
<p>Moreover, this <em>Output</em> has a garbage collector that will clean old data from
the database occasionally. This is an optional process, as old data is marked
&#8216;disabled&#8217;, and can actually be useful to keep around for debugging purpose.</p>
<p><em>Outputs</em> of type &#8216;SQL&#8217; have the following parameters:</p>
<dl class="docutils">
<dt>DB Type</dt>
<dd>The type of the database being accessed.
MariaDB is a state-of-the-art database that has been extensively tested
with Centreon. We advice the use of MariaDB.</dd>
<dt>DB Port</dt>
<dd>The port of the database being accessed.</dd>
<dt>DB User</dt>
<dd>The user used by this <em>Output</em> to connect to this database.</dd>
<dt>DB Name</dt>
<dd>The name of this database. In Centreon term, this is the database
containing the real-time monitoring data, generally called
&#8216;centreon-storage&#8217;.</dd>
<dt>DB Password</dt>
<dd>The password used by this <em>Output</em> to connect to this database.</dd>
<dt>Maximum queries per transaction</dt>
<dd>This parameter is used to batch several
queries in large transaction. This allow fine performance tuning but
can generate latency if not enough queries are generated to fill those batches.
The Default is 20000 queries per transaction. If you have very low load and
unexpectedly high latency, try lowering this number. If you have a very high
load and high latency, try raising this number.</dd>
<dt>Transaction commit timeout</dt>
<dd>How many seconds are allowed to pass before
a forced commit is made. Default is infinite. If you have very low
load and unexpectedly high latency, try 5 seconds.</dd>
<dt>Replication enabled</dt>
<dd>Should Centreon Broker check that the replication status
of this database is complete before trying to insert data in it? Only useful
if replication is enabled for this database.</dd>
<dt>Cleanup check interval</dt>
<dd>How many seconds between each run of the garbage
collector cleaning old data in the database? Default is never.</dd>
<dt>Instance timeout</dt>
<dd>How many seconds before an instance is marked as
&#8216;unresponding&#8217; and all of its hosts and services marked as &#8216;unknown&#8217;.
Default is 300 seconds.</dd>
</dl>
</div>
<div class="section" id="dumper-reader-writer">
<h3>Dumper Reader/Writer<a class="headerlink" href="#dumper-reader-writer" title="Permalink to this headline">¶</a></h3>
<p>A Dumper Reader/Writer pair is used to synchronize part of a database
between two instances of Centreon Broker. In the future there will be an
extensive synchronization mechanism, but today it is mainly used to
synchronize BA for the BAM Poller Display mechanism.</p>
<p>The BAM Poller Display configuration documentation explains how to properly
configure those <em>Outputs</em>.</p>
<p><em>Outputs</em> of type &#8216;Dumper Reader&#8217; and &#8216;Dumper Writer&#8217; have the following parameters:</p>
<dl class="docutils">
<dt>DB Type</dt>
<dd>The type of the database being accessed.
MariaDB is a state-of-the-art database that has been extensively tested
with Centreon. We advice the use of MariaDB.</dd>
<dt>DB Port</dt>
<dd>The port of the database being accessed.</dd>
<dt>DB User</dt>
<dd>The user used by this <em>Output</em> to connect to this database.</dd>
<dt>DB Name</dt>
<dd>The name of this database. In Centreon term, this is the database
containing the configuration data, generally called &#8216;centreon&#8217;.</dd>
<dt>DB Password</dt>
<dd>The password used by this <em>Output</em> to connect to this database.</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Configuring Broker</a><ul>
<li><a class="reference internal" href="#general-overview">General Overview</a></li>
<li><a class="reference internal" href="#main-configuration-page">Main Configuration Page</a></li>
<li><a class="reference internal" href="#broker-general-configuration-page">Broker General Configuration Page</a></li>
<li><a class="reference internal" href="#broker-input-configuration-page">Broker Input Configuration Page</a></li>
<li><a class="reference internal" href="#broker-logger-configuration-page">Broker Logger Configuration Page</a></li>
<li><a class="reference internal" href="#broker-output-configuration-page">Broker Output Configuration Page</a><ul>
<li><a class="reference internal" href="#tcp-outputs">TCP Outputs</a></li>
<li><a class="reference internal" href="#file-outputs">File Outputs</a></li>
<li><a class="reference internal" href="#rrd-outputs">RRD Outputs</a></li>
<li><a class="reference internal" href="#storage-outputs">Storage Outputs</a></li>
<li><a class="reference internal" href="#sql-outputs">SQL Outputs</a></li>
<li><a class="reference internal" href="#dumper-reader-writer">Dumper Reader/Writer</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="02k.html"
                        title="previous chapter">Managing SNMP traps with Centreon</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../upgrade/index.html"
                        title="next chapter">Upgrade</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/administration_guide/02l.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../upgrade/index.html" title="Upgrade"
             >next</a> |</li>
        <li class="right" >
          <a href="02k.html" title="Managing SNMP traps with Centreon"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Centreon 2.7.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Administration</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Centreon.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>