=========================
Gestion de la supervision
=========================

*********************
Acquitter un problème
*********************

Principe
========

Lorsqu'un hôte ou un service présente un problème, après la validation du statut de l'hôte ou du service une notification est envoyée.
Si après x minutes le problème n'est pas réglé, il est possible d'envoyer une seconde alerte...

L'acquittement d'un problème permet de mettre un terme à l'envoi de notifications jusqu'à ce que l'hôte ou le service retrouve un statut normal.
Exemple d'utilisation : 

Un service est chargé de vérifier la santé des disques durs d'une baie de disque.
Un disque dur physique tombe en panne sur une baie de disque : une notification est envoyée.
L'administrateur de supervision acquitte le service en précisant qu'une équipe est en train de régler le problème.
Les notifications ne sont plus envoyées jusqu'à ce que le disque dur physique soit remplacé.

Pratique
========

Pour acquitter un hôte ou un service :

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le ou les hôtes/services que vous souhaitez acquitter
#. Dans le menu **Plus d'actions** cliquez sur **Hôtes : Acquitter** ou sur **Services : Acquitter**

La fenêtre suivante s'affiche :

[ TODO Afficher la fenêtre]

* Si la case **Acquittement persistant en cas de changement de statut non-OK** est cochée : si l'hôte passe du statut DOWN à UNREACHABLE ou bien si le service passe du statut WARNING à CRITICAL alors l'acquittement demeure
* Si la case **Notifier** est cochée alors un mail de notification est envoyé aux contacts liés à l'hôte ou au service pour les avertir que le service a été acquitté
* Si la case **Acquittement persistant en cas de redémarrage de l'ordonnanceur** est cochée : si le moteur de supervision est redémarré l'acquittement demeure
* Le champ **Commentaire** est généralement utilisé pour fournir la raison de l'acquittement
* Si la case **Acquitter les services liés à l'hôte** est cochée alors tous les services liés à l'hôte seront acquittés (visible uniquement si vous acquittez un hôte)
* Si la case **Forcer les contrôles actifs** est cochée alors dès la validation de l'acquittement le moteur de supervision déclenchera une vérification de l'hôte (ou du service)

Pour dés-acquitter un hôte ou un service :

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le ou les hôtes/services que vous souhaitez acquitter
#. Dans le menu **Plus d'actions** cliquez sur **Hôtes : Dés-acquitter** ou sur **Services : Dés-acquitter**

**********************
Ajouter un commentaire
**********************

Principe
========

Pour un hôte ou un service, il est possible d'ajouter un commentaire.
Le commentaire est en général utilisé pour fournir une information sur la supervision de l'hôte.

Pratique
========

Il y a deux manières d'ajouter un commentaire :

* Le faire depuis la fiche de l'hôte ou du service
* Le faire depuis la catégorie **Commentaires**

Depuis la fiche
---------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Cliquez sur l'hôte/le service sur lequel vous souhaitez ajouter un commentaire
#. Dans la catégorie **Commandes disponibles** cliquez sur **Ajouter un commentaire pour cet hôte/ce service**

Depuis la catégorie **Commentaires**
------------------------------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Dans le menu de gauche, sous **Moteur de supervision**, cliquez sur **Commentaires**
#. Cliquez sur **Ajouter un commentaire**

Attributs
---------

La fenêtre suivante s'affiche :

[ TODO Mettre une capture d'écran]

* Le champ **Nom de l'hôte** définit l'hôte concerné par le commentaire
* Si vous avez choisit d'ajouter un commentaire pour un service le champ **Service** vous permet de sélectionner le service concerné par le commentaire
* Si la case **Acquittement persistant en cas de redémarrage de l'ordonnanceur** [ TODO : La bonne traduction ne serait-elle pas plutôt "Commentaire persistant en cas de redémarrage de l'ordonnanceur" ? ] vous permet de conserver le commentaire après un redémarrage du moteur de supervision
* Le champ **Commentaire** contient le commentaire

***************************
Programmer un temps d'arrêt
***************************

Principe
========

Un temps d'arrêt est une période de temps durant laquelle les notifications sont désactivées pour un hôte ou un service.
Les temps d'arrêts sont pratiques lors d'opérations de maintenance sur un hôte ou un service : ils permettent d'éviter de recevoir des alertes de type faux-positif.

Il existe deux types de temps d'arrêts :

* Les temps d'arrêts fixe : C'est à dire que le temps d'arrêt a lieu exactement pendant la période de temps définie.
* Les temps d'arrêts flexible : C'est à dire que si pendant la période de temps définie le service ou l'hôte retourne un statut non-OK alors le temps d'arrêt dure un certain nombre de secondes (à définir dans le formulaire) à partir du moment où l'hôte ou le statut a retourné un statut non-OK.

Pratique
========

Il y a trois manières de définir un temps d'arrêt :

* Le faire depuis la fiche de l'hôte ou du service
* Le faire depuis la liste des hôtes ou des services
* Le faire dans la catégorie **Temps d'arrêt**

Depuis la fiche
---------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Cliquez sur l'hôte/le service sur lequel vous souhaitez planifier un temps d'arrêt
#. Dans la catégorie **Commandes** cliquez sur **Planifier un arrêt pour cet hôte/ce service**

Depuis la liste
---------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le ou les hôtes/services pour lesquels vous souhaitez planifier un temps d'arrêt
#. Dans le menu **Plus d'actions...** cliquez sur **Hôtes : Planifier un temps d'arrêt** ou **Services : Planifier un temps d'arrêt**

Depuis la catégorie **Temps d'arrêt**
-------------------------------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Dans le menu de gauche, sous **Moteur de supervision**, cliquez sur **Temps d'arrêt**
#. Cliquez sur **Ajouter un temps d'arrêt**

Attributs
---------

* Le champ **Nom de l'hôte** définit l'hôte concerné par le temps d'arrêt
* Le champ **Service** définit le service concerné par le temps d'arrêt
* Si la case **Fixe** est cochée alors le temps d'arrêt est fixe. Sinon, il est flexible
* Si le temps d'arrêt est flexible, le champ **Durée** définit la durée du temps d'arrêt
* Les champs **Date et heure de début** et **Date et heure de fin** définissent les dates de début et de fin du temps d'arrêt
* Le champ **Commentaires** sert à indiquer pourquoi le temps d'arrêt est programmé

*************************
Gestion des vérifications
*************************

Principe
========

Il est possible d'activer ou de désactiver momentanément la vérification d'un hôte ou d'un service.
ATTENTION : La modification des paramètres de vérifications n'impacte pas la configuration de l'objet en base de données.

Ces modifications sont faites sur la supervision en temps-réel, elles sont annulées à partir du moment où le moteur de supervision est redémarré.

Pratique
========

Il y a deux moyens de gérer les vérifications :

* Le faire depuis la fiche de l'hôte ou du service
* Le faire depuis la liste des hôtes ou des services

Depuis la fiche
---------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Cliquez sur l'hôte/le service sur lequel vous souhaitez arrêter ou relancer la vérification
#. Dans la catégorie **Options**, rendez-vous à la ligne **Contrôles actifs** pour vérifier l'état des contrôles. Pour

* Désactiver la vérification, cliquez sur [ TODO Mettre l'icône]
* Activer la vérification, cliquez sur [ TODO Mettre l'icône]

Depuis la liste
---------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le ou les hôtes/services pour lesquels vous souhaitez activer ou de désactiver la vérification
#. Dans le menu **Plus d'actions...** cliquez sur :

* **Hôtes : Désactiver la vérification** ou **Services : Désactiver la vérification** pour arrêter la vérification d'un hôte ou d'un service
* **Hôtes : Activer la vérification** ou **Services : Activer la vérification** pour activer la vérification d'un hôte ou d'un service

*********************
Soumettre un résultat
*********************

Principe
========

Dans le cas où un service est passif, il peut arriver que le service ne reçoit aucune trap pendant plusieurs jours.
Il est possible de soumettre un résultat aux services passifs afin de forcer l'affichage d'un résultat.

Pratique
========

Pour soumettre un résultat :

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Cliquez sur le service passif pour lequel vous souhaitez forcer l'affichage d'un résultat
#. Dans la catégorie **Commandes du service** cliquez sur **Soumettre un résultat pour ce service**

* Les champs **Nom de l'hôte** et **Service** définissent l'hôte et le service pour lequel le résultat sera soumit
* Le champ **Résultat du contrôle** définit le statut du service
* Le champ **Sortie du contrôle** définit le message à afficher pour le service
* Le champ **Données de performance** permet de définir des données de performances pour la génération des graphes

*************************
Gestion des notifications
*************************

Principe
========

Il est possible d'activer ou de désactiver momentanément la notification d'un hôte ou d'un service.
ATTENTION : La modification des paramètres de notifications n'impacte pas la configuration de l'objet en base de données.

Ces modifications sont faites sur la supervision en temps-réel, elles sont annulées à partir du moment où le moteur de supervision est redémarré.

Pratique
========

Il y a deux moyens de gérer les notifications :

* Le faire depuis la fiche de l'hôte ou du service
* Le faire depuis la liste des hôtes ou des services

Depuis la fiche
---------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Cliquez sur l'hôte/le service sur lequel vous souhaitez arrêter ou relancer la notification
#. Dans la catégorie **Options**, rendez-vous à la ligne **Notifications** pour l'envoi des notifications. Pour

* Désactiver la notification, cliquez sur [ TODO Mettre l'icône]
* Activer la notification, cliquez sur [ TODO Mettre l'icône]

Depuis la liste
---------------

#. Rendez-vous dans **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le ou les hôtes/services pour lesquels vous souhaitez activer ou de désactiver la notification
#. Dans le menu **Plus d'actions...** cliquez sur :

* **Hôtes : Désactiver la notification** ou **Services : Désactiver la notification** pour arrêter la notification d'un hôte ou d'un service
* **Hôtes : Activer la notification** ou **Services : Activer la notification** pour activer la notification d'un hôte ou d'un service

***************************
Programmer une vérification
***************************

Principe
========

Il est possible de programmer la vérification d'un service. La programmation consiste à mettre la vérification du service en priorité dans la queue de traitement du moteur de supervision.
Il existe deux types de programmation :

* La programmation classique : la vérification du service est mise en priorité dans la file d'attente du moteur de supervision
* La programmation forcée : la vérification du service est mise en priorité dans la file d'attente du moteur de supervision mais si le service est en cours de vérification alors la vérification est arrêtée (permet de killer les sondes qui sont devenues des zombies)

Pratique
========

Il y a deux moyens de forcer la vérification d'un service :

* Le faire depuis la fiche du service
* Le faire depuis la liste des services

Depuis la fiche
---------------

#. Rendez-vous dans **Supervision** ==> **Services**
#. Cliquez sur le service pour lequel vous souhaitez forcer la vérification d'un service
#. Dans la catégorie **Commandes du service**, cliquez sur **Re-planifier le prochain contrôle pour ce service** ou **Re-planifier le prochain contrôle pour ce service (Forcé)**

Depuis la liste
---------------

#. Rendez-vous dans **Supervision** ==> **Services**
#. Sélectionnez le ou les services pour lesquels vous souhaitez forcer la vérification
#. Dans le menu **Plus d'actions...** cliquez sur **Planifier un contrôle immédiat** ou **Planifier un contrôle immédiat (Forcé)**